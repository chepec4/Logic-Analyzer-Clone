name: Build C4 Analyzer (Logic Pro Edition)

on: [push, workflow_dispatch]

jobs:
  build-windows:
    name: Compilar en Windows
    runs-on: windows-latest
    
    steps:
    - name: Checkout del CÃ³digo
      uses: actions/checkout@v4

    - name: Instalar MinGW
      uses: egor-tensin/setup-mingw@v2
      with:
        platform: x64
        version: 12.2.0

    # --- NUEVO PASO: DESCARGA DEL VST SDK ---
    # Descargamos el SDK faltante a una carpeta temporal 'vstsdk_rescue'
    - name: Descargar VST SDK (Rescue)
      run: |
        git clone https://github.com/asb2m10/vstsdk2.4.git ../vstsdk_rescue
        ls -R ../vstsdk_rescue
      shell: bash
    # ----------------------------------------

    - name: Compilar C4 Analyzer
      working-directory: src
      run: mingw32-make

    - name: Verificar DLL
      run: ls -l ..
      shell: bash

    - name: Subir Artefacto
      uses: actions/upload-artifact@v4
      with:
        name: C4Analyzer-VST
        path: C4Analyzer.dll
